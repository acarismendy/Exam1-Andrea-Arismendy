<!DOCTYPE html>
<html>
  <head>
     <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Exam1-andrea-arismendy : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script type="text/javascript" src="javascripts/d3.js"></script>

    <title>Exam1-andrea-arismendy</title>
  </head>
  
  <body>
   <!--Header-->
    <div id="header">
      <h1>Stacked</h1>
    </div>
  
    <!--Graph-->
    <div id="barChart">
    
    </div>
    
    <script type="text/javascript">
      d3.json("https://hivelab.org/static/exam1.json",function(data){
       var cumulativeStudents=new Array();
       var values=new Array();
       var labels=d3.keys(data);
       var height=400;
       var width=600;
       var padding=30;
       labels.shift();
       var svg=d3.select("#barChart").append("svg")
                  .attr("height",height)
                  .attr("width",width)
                  .attr("class", "graph");
       for(var i=0;i<labels.length;i++){
       	cumulativeStudents[i]=0;
       }
       for(var i=0;i<labels.length;i++){
       	values=d3.values(data[i]);
       	
               svg.selectAll("rect")
                  .data(values)
                  .enter()
                  .append("rect")
                  .attr("x",function(d,i){return i*width/values.length+padding+9;})
                  .attr("height",function(d,i){return values[i]*(height-padding)/100-padding;})
                  .attr("y",function(d,i){return height-values[i]*(height-padding)/100-padding+cumulativeStudents[i];})
                  .attr("fill","black")
                  .attr("width",width/values.length-padding);
                //svg.selectAll("text")
                //    .data(values)
                //    .enter()
                //    .append("text")
                    //.text(function(d,i){return values[i];})
                    //.attr("fill","red")
                    //.attr("x",function(d,i){return i*width/values.length+2*padding+9;})
                    //.attr("y",function(d,i){return height-values[i]*(height-2*padding)/100-padding;-20});
         
        var yScale=d3.scale.linear();
                    yScale.domain([100,0])
                          .range([padding,height-padding-5]);
        var yAxis=d3.svg.axis()
                    .scale(yScale)
                    .orient("left")
                    .ticks(10);
            svg.append("g")
               .attr("class","axis")
               .attr("transform","translate("+(padding+9)+",-"+(padding-5)+")")
               .call(yAxis);
        var xScale= d3.scale.ordinal()
                      .domain(labels)
                      .rangePoints([padding, 530]);            
        var xAxis= d3.svg.axis()
                     .scale(xScale)
                     .orient("bottom")
                     .ticks(6);
            svg.append("g")
               .attr("class","axis")
               .attr("transform","translate(9,"+(height-2*padding)+")")
               .call(xAxis)
               .selectAll("text")
                .attr("y",0 )
               .attr("transform", "translate(3,2)")
               .style("text-anchor", "start")
               .attr("fill","black");
                   
                   cumulativeStudents[i]=cumulativeStudents[i]+values[i];   
             
      	
       }
       svg.append("text")
                .attr("class","name")
                .attr("text-anchor","end")
                .attr("y",12)
                .attr("x",-10)
                .attr("transform","rotate(-90)")
                .text("Number of IE senior students")
                .style("fill","black");
            svg.append("text")
                .attr("class","name")
                .attr("text-anchor","end")
                .attr("y",380)
                .attr("x",200)
                .text("University")
                .style("fill","black"); 
       
                    
      });
    </script>
  </body>
  </body>

</html>
